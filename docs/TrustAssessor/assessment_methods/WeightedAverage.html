<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>src.TrustAssessor.assessment_methods.WeightedAverage API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>src.TrustAssessor.assessment_methods.WeightedAverage</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">from TrustAssessor.assessment_methods.AssessmentMethod import AssessmentMethod
from anytree import Node
from anytree.exporter import JsonExporter, DictExporter
from math import isclose

class WeightedAverage(AssessmentMethod):
    &#34;&#34;&#34;Class that implements the trust assessment using as a weighted average. It uses the weights and hierarchy specified in the configuration file (previously loaded into the additionalProperties constructor&#39;s parameter).
    
    This class is able to process arbitrary hierarchies, although the weight&#39;s sum of each level must add to 1 to ensure the assessment&#39;s consistency.
    &#34;&#34;&#34;
    
    def __init__(self, additionalProperties):
        &#34;&#34;&#34;Retrieves the dict containing the hierarchical tree to use from the additionalProperties parameter and prepares the instance&#39;s attributes to perform the trust assessment.

        Args:
            additionalProperties (dict): [dictionary of parameters required by the assessment method, i.e., the hierarchical tree containing weights for each level]
        &#34;&#34;&#34;

        super().__init__()
        self.hierarchyTree = additionalProperties
    
    def assess(self):
        &#34;&#34;&#34;Assesses the trust as a weighted average and stores the assessment. To ensure the assessment&#39;s explainability and traceability,
        this method produces a tree containing the hierarchical assessment, with the raw weighted and unweighted metrics&#39; assessments, as well as the upper levels of the hierarchy. It leverages the hierarchical tree computation to the &#34;evaluate_tree&#34; function. Stores the result as a JSON formatted string and as a dict containing the unweighted and weighted scores at each level of the tree.
        &#34;&#34;&#34;

        trust_hiearchy_node = Node(name=&#34;Trust&#34;)

        trust_hiearchy_node.weighted_score = round(self.evaluate_tree(self.hierarchyTree, trust_hiearchy_node), 2)

        exporter = JsonExporter(indent=2)
        self.assessmentAsFormattedString = exporter.export(trust_hiearchy_node)
        self.assessment = DictExporter().export(trust_hiearchy_node)

        return trust_hiearchy_node.weighted_score

    def evaluate_tree(self, dict_node, hiearchy_parent_node):
        &#34;&#34;&#34;Recursive function that validates and assesses a certain level of the trust hierarchy tree as a weighted average.
        When such level is not a leaf node, the assessment is performed recursively. When it is a leaf node, the assessment
        is performed by taking the raw metric&#39;s value (i.e., score) from the metrics&#39; list and its weight extracted from the additionalProperties dict.
 
        Args:
            dict_node (dict): Current tree&#39;s level to evaluate
            hiearchy_parent_node (anytree&#39;s Node): Parent node, used to link the current evaluated node with its parent

        Raises:
            Exception: When the hierarchy&#39;s weights are not consistent, i.e., any level of the tree does not add up to 1.

        Returns:
            float: weighted score for a hierarchy level (recursively).
        &#34;&#34;&#34;
        tree_score = node_accumulated_weight = 0
        for node in dict_node:
            node_score = node_weight = 0
            hiearchy_child_node = Node(name=node, parent=hiearchy_parent_node)
            if type(dict_node[node]) is dict:
                hiearchy_child_node.name = node.split(&#34;-&#34;)[0]
                node_weight = float(node.split(&#34;-&#34;)[1])
                hiearchy_child_node.weight = node_weight
                node_raw_score = self.evaluate_tree(dict_node[node], hiearchy_child_node)
            else:
                node_weight = dict_node[node]
                hiearchy_child_node.weight = node_weight
                node_raw_score = self.getMetricsAssessmentDict()[node]
            node_score = node_weight * node_raw_score
            tree_score += node_score
            hiearchy_child_node.weighted_score = round(node_score, ndigits=2)
            hiearchy_child_node.raw_score = round(node_raw_score, ndigits=2)
            node_accumulated_weight += node_weight
        if isclose(node_accumulated_weight, 1):
            return tree_score
        else:
            raise Exception(&#34;Validation error in configuration file: weights do not add up to 1 (&#34; + str(node_accumulated_weight) + &#34;) in: \n&#34; + str(dict_node))</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="src.TrustAssessor.assessment_methods.WeightedAverage.WeightedAverage"><code class="flex name class">
<span>class <span class="ident">WeightedAverage</span></span>
<span>(</span><span>additionalProperties)</span>
</code></dt>
<dd>
<div class="desc"><p>Class that implements the trust assessment using as a weighted average. It uses the weights and hierarchy specified in the configuration file (previously loaded into the additionalProperties constructor's parameter).</p>
<p>This class is able to process arbitrary hierarchies, although the weight's sum of each level must add to 1 to ensure the assessment's consistency.</p>
<p>Retrieves the dict containing the hierarchical tree to use from the additionalProperties parameter and prepares the instance's attributes to perform the trust assessment.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>additionalProperties</code></strong> :&ensp;<code>dict</code></dt>
<dd>[dictionary of parameters required by the assessment method, i.e., the hierarchical tree containing weights for each level]</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class WeightedAverage(AssessmentMethod):
    &#34;&#34;&#34;Class that implements the trust assessment using as a weighted average. It uses the weights and hierarchy specified in the configuration file (previously loaded into the additionalProperties constructor&#39;s parameter).
    
    This class is able to process arbitrary hierarchies, although the weight&#39;s sum of each level must add to 1 to ensure the assessment&#39;s consistency.
    &#34;&#34;&#34;
    
    def __init__(self, additionalProperties):
        &#34;&#34;&#34;Retrieves the dict containing the hierarchical tree to use from the additionalProperties parameter and prepares the instance&#39;s attributes to perform the trust assessment.

        Args:
            additionalProperties (dict): [dictionary of parameters required by the assessment method, i.e., the hierarchical tree containing weights for each level]
        &#34;&#34;&#34;

        super().__init__()
        self.hierarchyTree = additionalProperties
    
    def assess(self):
        &#34;&#34;&#34;Assesses the trust as a weighted average and stores the assessment. To ensure the assessment&#39;s explainability and traceability,
        this method produces a tree containing the hierarchical assessment, with the raw weighted and unweighted metrics&#39; assessments, as well as the upper levels of the hierarchy. It leverages the hierarchical tree computation to the &#34;evaluate_tree&#34; function. Stores the result as a JSON formatted string and as a dict containing the unweighted and weighted scores at each level of the tree.
        &#34;&#34;&#34;

        trust_hiearchy_node = Node(name=&#34;Trust&#34;)

        trust_hiearchy_node.weighted_score = round(self.evaluate_tree(self.hierarchyTree, trust_hiearchy_node), 2)

        exporter = JsonExporter(indent=2)
        self.assessmentAsFormattedString = exporter.export(trust_hiearchy_node)
        self.assessment = DictExporter().export(trust_hiearchy_node)

        return trust_hiearchy_node.weighted_score

    def evaluate_tree(self, dict_node, hiearchy_parent_node):
        &#34;&#34;&#34;Recursive function that validates and assesses a certain level of the trust hierarchy tree as a weighted average.
        When such level is not a leaf node, the assessment is performed recursively. When it is a leaf node, the assessment
        is performed by taking the raw metric&#39;s value (i.e., score) from the metrics&#39; list and its weight extracted from the additionalProperties dict.
 
        Args:
            dict_node (dict): Current tree&#39;s level to evaluate
            hiearchy_parent_node (anytree&#39;s Node): Parent node, used to link the current evaluated node with its parent

        Raises:
            Exception: When the hierarchy&#39;s weights are not consistent, i.e., any level of the tree does not add up to 1.

        Returns:
            float: weighted score for a hierarchy level (recursively).
        &#34;&#34;&#34;
        tree_score = node_accumulated_weight = 0
        for node in dict_node:
            node_score = node_weight = 0
            hiearchy_child_node = Node(name=node, parent=hiearchy_parent_node)
            if type(dict_node[node]) is dict:
                hiearchy_child_node.name = node.split(&#34;-&#34;)[0]
                node_weight = float(node.split(&#34;-&#34;)[1])
                hiearchy_child_node.weight = node_weight
                node_raw_score = self.evaluate_tree(dict_node[node], hiearchy_child_node)
            else:
                node_weight = dict_node[node]
                hiearchy_child_node.weight = node_weight
                node_raw_score = self.getMetricsAssessmentDict()[node]
            node_score = node_weight * node_raw_score
            tree_score += node_score
            hiearchy_child_node.weighted_score = round(node_score, ndigits=2)
            hiearchy_child_node.raw_score = round(node_raw_score, ndigits=2)
            node_accumulated_weight += node_weight
        if isclose(node_accumulated_weight, 1):
            return tree_score
        else:
            raise Exception(&#34;Validation error in configuration file: weights do not add up to 1 (&#34; + str(node_accumulated_weight) + &#34;) in: \n&#34; + str(dict_node))</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>TrustAssessor.assessment_methods.AssessmentMethod.AssessmentMethod</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="src.TrustAssessor.assessment_methods.WeightedAverage.WeightedAverage.assess"><code class="name flex">
<span>def <span class="ident">assess</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Assesses the trust as a weighted average and stores the assessment. To ensure the assessment's explainability and traceability,
this method produces a tree containing the hierarchical assessment, with the raw weighted and unweighted metrics' assessments, as well as the upper levels of the hierarchy. It leverages the hierarchical tree computation to the "evaluate_tree" function. Stores the result as a JSON formatted string and as a dict containing the unweighted and weighted scores at each level of the tree.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def assess(self):
    &#34;&#34;&#34;Assesses the trust as a weighted average and stores the assessment. To ensure the assessment&#39;s explainability and traceability,
    this method produces a tree containing the hierarchical assessment, with the raw weighted and unweighted metrics&#39; assessments, as well as the upper levels of the hierarchy. It leverages the hierarchical tree computation to the &#34;evaluate_tree&#34; function. Stores the result as a JSON formatted string and as a dict containing the unweighted and weighted scores at each level of the tree.
    &#34;&#34;&#34;

    trust_hiearchy_node = Node(name=&#34;Trust&#34;)

    trust_hiearchy_node.weighted_score = round(self.evaluate_tree(self.hierarchyTree, trust_hiearchy_node), 2)

    exporter = JsonExporter(indent=2)
    self.assessmentAsFormattedString = exporter.export(trust_hiearchy_node)
    self.assessment = DictExporter().export(trust_hiearchy_node)

    return trust_hiearchy_node.weighted_score</code></pre>
</details>
</dd>
<dt id="src.TrustAssessor.assessment_methods.WeightedAverage.WeightedAverage.evaluate_tree"><code class="name flex">
<span>def <span class="ident">evaluate_tree</span></span>(<span>self, dict_node, hiearchy_parent_node)</span>
</code></dt>
<dd>
<div class="desc"><p>Recursive function that validates and assesses a certain level of the trust hierarchy tree as a weighted average.
When such level is not a leaf node, the assessment is performed recursively. When it is a leaf node, the assessment
is performed by taking the raw metric's value (i.e., score) from the metrics' list and its weight extracted from the additionalProperties dict.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>dict_node</code></strong> :&ensp;<code>dict</code></dt>
<dd>Current tree's level to evaluate</dd>
</dl>
<p>hiearchy_parent_node (anytree's Node): Parent node, used to link the current evaluated node with its parent</p>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>Exception</code></dt>
<dd>When the hierarchy's weights are not consistent, i.e., any level of the tree does not add up to 1.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>float</code></dt>
<dd>weighted score for a hierarchy level (recursively).</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def evaluate_tree(self, dict_node, hiearchy_parent_node):
    &#34;&#34;&#34;Recursive function that validates and assesses a certain level of the trust hierarchy tree as a weighted average.
    When such level is not a leaf node, the assessment is performed recursively. When it is a leaf node, the assessment
    is performed by taking the raw metric&#39;s value (i.e., score) from the metrics&#39; list and its weight extracted from the additionalProperties dict.

    Args:
        dict_node (dict): Current tree&#39;s level to evaluate
        hiearchy_parent_node (anytree&#39;s Node): Parent node, used to link the current evaluated node with its parent

    Raises:
        Exception: When the hierarchy&#39;s weights are not consistent, i.e., any level of the tree does not add up to 1.

    Returns:
        float: weighted score for a hierarchy level (recursively).
    &#34;&#34;&#34;
    tree_score = node_accumulated_weight = 0
    for node in dict_node:
        node_score = node_weight = 0
        hiearchy_child_node = Node(name=node, parent=hiearchy_parent_node)
        if type(dict_node[node]) is dict:
            hiearchy_child_node.name = node.split(&#34;-&#34;)[0]
            node_weight = float(node.split(&#34;-&#34;)[1])
            hiearchy_child_node.weight = node_weight
            node_raw_score = self.evaluate_tree(dict_node[node], hiearchy_child_node)
        else:
            node_weight = dict_node[node]
            hiearchy_child_node.weight = node_weight
            node_raw_score = self.getMetricsAssessmentDict()[node]
        node_score = node_weight * node_raw_score
        tree_score += node_score
        hiearchy_child_node.weighted_score = round(node_score, ndigits=2)
        hiearchy_child_node.raw_score = round(node_raw_score, ndigits=2)
        node_accumulated_weight += node_weight
    if isclose(node_accumulated_weight, 1):
        return tree_score
    else:
        raise Exception(&#34;Validation error in configuration file: weights do not add up to 1 (&#34; + str(node_accumulated_weight) + &#34;) in: \n&#34; + str(dict_node))</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="src.TrustAssessor.assessment_methods" href="index.html">src.TrustAssessor.assessment_methods</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="src.TrustAssessor.assessment_methods.WeightedAverage.WeightedAverage" href="#src.TrustAssessor.assessment_methods.WeightedAverage.WeightedAverage">WeightedAverage</a></code></h4>
<ul class="">
<li><code><a title="src.TrustAssessor.assessment_methods.WeightedAverage.WeightedAverage.assess" href="#src.TrustAssessor.assessment_methods.WeightedAverage.WeightedAverage.assess">assess</a></code></li>
<li><code><a title="src.TrustAssessor.assessment_methods.WeightedAverage.WeightedAverage.evaluate_tree" href="#src.TrustAssessor.assessment_methods.WeightedAverage.WeightedAverage.evaluate_tree">evaluate_tree</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>